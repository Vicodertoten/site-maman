---
// NewsletterSignup.astro - Composant d'inscription à la newsletter
---

<div id="newsletter-signup" class="bg-mv-cream rounded-lg p-6 my-8 border border-mv-leaf/20">
  <div class="text-center">
    <h3 class="text-xl font-serif font-bold text-mv-forest mb-2">
      Restez informé(e)
    </h3>
    <p class="text-mv-forest/80 mb-4">
      Recevez mes dernières recettes et conseils nutritionnels directement dans votre boîte mail.
    </p>

    <form id="newsletter-form" name="newsletter" method="POST" data-netlify="true" action="/merci" class="max-w-md mx-auto">
      <!-- Champ caché requis par Netlify Forms -->
      <input type="hidden" name="form-name" value="newsletter" />
      <div class="flex gap-2">
        <input
          type="email"
          name="email"
          id="newsletter-email"
          placeholder="Votre adresse email"
          class="flex-1 px-4 py-2 border border-mv-leaf/30 rounded-lg focus:ring-2 focus:ring-mv-leaf focus:border-mv-leaf bg-white"
          required
        />
        <button
          type="submit"
          id="newsletter-submit"
          class="bg-mv-leaf text-mv-cream px-6 py-2 mv-pill hover:bg-mv-forest hover:scale-105 transition-all duration-300 transform font-medium shadow-sm hover:shadow-md"
        >
          S'inscrire
        </button>
      </div>
      <p id="newsletter-message" class="text-sm mt-2 opacity-0 transition-opacity"></p>
    </form>
  </div>
</div>

<script>
  // Amélioration UX pour Netlify Forms
  document.addEventListener('DOMContentLoaded', () => {
    const form = document.getElementById('newsletter-form') as HTMLFormElement;
    const submitButton = document.getElementById('newsletter-submit') as HTMLButtonElement;

    // Indicateur de chargement pendant la soumission
    form.addEventListener('submit', () => {
      submitButton.disabled = true;
      submitButton.textContent = 'Inscription...';
    });

    // Netlify Forms gère automatiquement la redirection vers /merci
    // en cas de succès, ou affiche les erreurs directement
  });
</script>